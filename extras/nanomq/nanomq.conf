# NanoMQ Configuration with Persistent Sessions
# Based on NanoMQ 0.19.0+

# #============================================================
# # NanoMQ Server
# #============================================================

mqtt {
    property_size = 32
    max_packet_size = 256MB
    max_mqueue_len = 2048
    retry_interval = 1s
    keepalive_multiplier = 1.25

    # Session expiry settings
    session_expiry_interval = 7200  # 2 hours default
    max_inflight_window = 2048
    max_awaiting_rel = 10s
    await_rel_timeout = 10s
}

# #============================================================
# # SQLite for Message Persistence
# #============================================================

sqlite {
    enable = true
    # Enable disk cache for persistent sessions
    disk_cache_size = 102400  # 100MB cache

    # Mounted file path for SQLite database
    mounted_file_path = "/tmp/nanomq_data.db"

    # Flush memory data to disk interval (ms)
    flush_mem_threshold = 100

    # Resend interval for QoS 1/2 messages (ms)
    resend_interval = 500
}

log {
    to = [console]
    level = warn
}

auth {
    allow_anonymous = true
    no_match = allow
    deny_action = ignore
}

